/* =============================================================================
   DROPDOWN MENU COMPONENT TOKENS
   Override globally: :root { --stuic-dropdown-menu-radius: 0; }
   Override locally:  <DropdownMenu style="--stuic-dropdown-menu-radius: 9999px;">
   ============================================================================= */

:root {
	/* Structure tokens */
	--stuic-dropdown-menu-radius: var(--radius-md);
	--stuic-dropdown-menu-padding: calc(var(--spacing) * 1);
	--stuic-dropdown-menu-gap: calc(var(--spacing) * 0.5);
	--stuic-dropdown-menu-min-width: 12rem;
	--stuic-dropdown-menu-transition: 150ms;

	/* Dropdown container colors */
	--stuic-dropdown-menu-bg: var(--stuic-color-background);
	--stuic-dropdown-menu-text: var(--stuic-color-foreground);
	--stuic-dropdown-menu-border: var(--stuic-color-border);
	--stuic-dropdown-menu-shadow: var(--shadow-lg);

	/* Trigger button colors */
	--stuic-dropdown-menu-trigger-bg: var(--stuic-color-surface);
	--stuic-dropdown-menu-trigger-bg-hover: var(--stuic-color-surface-hover);
	--stuic-dropdown-menu-trigger-bg-active: var(--stuic-color-surface-active);
	--stuic-dropdown-menu-trigger-text: var(--stuic-color-surface-foreground);
	--stuic-dropdown-menu-trigger-text-hover: var(--stuic-color-surface-foreground-hover);
	--stuic-dropdown-menu-trigger-text-active: var(--stuic-color-surface-foreground-active);
	--stuic-dropdown-menu-trigger-border: var(--stuic-color-border);
	--stuic-dropdown-menu-trigger-border-hover: var(--stuic-color-border-hover);
	--stuic-dropdown-menu-trigger-border-active: var(--stuic-color-border-active);

	/* Trigger sizing */
	--stuic-dropdown-menu-trigger-padding-x: calc(var(--spacing) * 3);
	--stuic-dropdown-menu-trigger-padding-y: calc(var(--spacing) * 2);

	/* Focus ring */
	--stuic-dropdown-menu-ring-width: 3px;
	--stuic-dropdown-menu-ring-offset: 0px;
	--stuic-dropdown-menu-ring-color: var(--stuic-color-ring);

	/* Divider */
	--stuic-dropdown-menu-divider-bg: var(--stuic-color-border);
	--stuic-dropdown-menu-divider-height: 1px;
	--stuic-dropdown-menu-divider-margin-y: calc(var(--spacing) * 1);

	/* Header (section label) */
	--stuic-dropdown-menu-header-text: var(--stuic-color-muted-foreground);
	--stuic-dropdown-menu-header-font-size: var(--text-xs);
	--stuic-dropdown-menu-header-font-weight: var(--font-weight-semibold);
	--stuic-dropdown-menu-header-padding-x: calc(var(--spacing) * 2);
	--stuic-dropdown-menu-header-padding-y: calc(var(--spacing) * 1.5);
	--stuic-dropdown-menu-header-letter-spacing: 0.05em;
	--stuic-dropdown-menu-header-text-transform: uppercase;

	/* Backdrop (fallback mode) */
	--stuic-dropdown-menu-backdrop-bg: rgb(0 0 0 / 0.25);
	--stuic-dropdown-menu-backdrop-z-index: 40;

	/* Expandable section indent */
	--stuic-dropdown-menu-expandable-indent: calc(var(--spacing) * 4);

	/* Search */
	--stuic-dropdown-menu-search-bg: var(--stuic-color-background);
	--stuic-dropdown-menu-search-border: var(--stuic-color-border);
	--stuic-dropdown-menu-search-text: var(--stuic-color-muted-foreground);
}

@layer components {
	/* =============================================================================
	   BASE STYLES
	   ============================================================================= */

	.stuic-dropdown-menu {
		position: relative;
		display: inline-block;
	}

	/* =============================================================================
	   TRIGGER BUTTON
	   ============================================================================= */

	.stuic-dropdown-menu-trigger {
		/* Layout */
		display: inline-flex;
		align-items: center;
		justify-content: center;
		gap: var(--stuic-dropdown-menu-gap);

		/* Sizing */
		padding: var(--stuic-dropdown-menu-trigger-padding-y)
			var(--stuic-dropdown-menu-trigger-padding-x);

		/* Box model */
		border-width: 1px;
		border-style: solid;
		border-radius: var(--stuic-dropdown-menu-radius);

		/* Colors */
		background: var(--stuic-dropdown-menu-trigger-bg);
		color: var(--stuic-dropdown-menu-trigger-text);
		border-color: var(--stuic-dropdown-menu-trigger-border);

		/* Interaction */
		cursor: pointer;
		user-select: none;
		-webkit-tap-highlight-color: transparent;
		touch-action: manipulation;
		transition:
			background var(--stuic-dropdown-menu-transition),
			color var(--stuic-dropdown-menu-transition),
			border-color var(--stuic-dropdown-menu-transition);
	}

	.stuic-dropdown-menu-trigger:hover:not(:disabled) {
		background: var(--stuic-dropdown-menu-trigger-bg-hover);
		color: var(--stuic-dropdown-menu-trigger-text-hover);
		border-color: var(--stuic-dropdown-menu-trigger-border-hover);
	}

	.stuic-dropdown-menu-trigger:active:not(:disabled) {
		background: var(--stuic-dropdown-menu-trigger-bg-active);
		color: var(--stuic-dropdown-menu-trigger-text-active);
		border-color: var(--stuic-dropdown-menu-trigger-border-active);
	}

	.stuic-dropdown-menu-trigger:focus-visible {
		outline: var(--stuic-dropdown-menu-ring-width) solid
			var(--stuic-dropdown-menu-ring-color);
		outline-offset: var(--stuic-dropdown-menu-ring-offset);
	}

	/* =============================================================================
	   DROPDOWN CONTAINER
	   ============================================================================= */

	.stuic-dropdown-menu-dropdown {
		/* Colors */
		background: var(--stuic-dropdown-menu-bg);
		color: var(--stuic-dropdown-menu-text);
		border: 1px solid var(--stuic-dropdown-menu-border);
		box-shadow: var(--stuic-dropdown-menu-shadow);

		/* Box model */
		border-radius: var(--stuic-dropdown-menu-radius);
		padding: var(--stuic-dropdown-menu-padding);

		/* Layout */
		min-width: var(--stuic-dropdown-menu-min-width);
		overflow-y: auto;
		scrollbar-width: thin;

		/* Stacking */
		z-index: 50;
	}

	/* =============================================================================
	   DIVIDER
	   ============================================================================= */

	.stuic-dropdown-menu-divider {
		height: 0;
		margin: var(--stuic-dropdown-menu-divider-margin-y) 0;
		border-top: var(--stuic-dropdown-menu-divider-height) solid var(--stuic-dropdown-menu-divider-bg);
	}

	/* =============================================================================
	   HEADER (Section Label)
	   ============================================================================= */

	.stuic-dropdown-menu-header {
		padding: var(--stuic-dropdown-menu-header-padding-y)
			var(--stuic-dropdown-menu-header-padding-x);
		font-size: var(--stuic-dropdown-menu-header-font-size);
		font-weight: var(--stuic-dropdown-menu-header-font-weight);
		letter-spacing: var(--stuic-dropdown-menu-header-letter-spacing);
		text-transform: var(--stuic-dropdown-menu-header-text-transform);
		color: var(--stuic-dropdown-menu-header-text);
		user-select: none;
	}

	/* =============================================================================
	   BACKDROP (Fallback Mode)
	   ============================================================================= */

	.stuic-dropdown-menu-backdrop {
		position: fixed;
		inset: 0;
		background: var(--stuic-dropdown-menu-backdrop-bg);
		z-index: var(--stuic-dropdown-menu-backdrop-z-index);
		transition-property: opacity;
	}

	/* =============================================================================
	   EXPANDABLE SECTION
	   ============================================================================= */

	.stuic-dropdown-menu-expandable-content {
		padding-left: var(--stuic-dropdown-menu-expandable-indent);
		overflow: hidden;
	}

	/* =============================================================================
	   LIST ITEM BUTTON OVERRIDES FOR DROPDOWN CONTEXT
	   Reset default ListItemButton background to transparent within dropdown.
	   ============================================================================= */

	.stuic-dropdown-menu-dropdown .stuic-list-item-button {
		--stuic-list-item-button-bg: transparent;
		--stuic-list-item-button-border: transparent;
	}

	/* =============================================================================
	   CSS ANCHOR POSITIONING (when supported)
	   ============================================================================= */

	@position-try --pop-top {
		position-area: top;
	}
	@position-try --pop-top-span-right {
		position-area: top span-right;
	}
	@position-try --pop-top-span-left {
		position-area: top span-left;
	}
	@position-try --pop-bottom {
		position-area: bottom;
	}
	@position-try --pop-bottom-span-right {
		position-area: bottom span-right;
	}
	@position-try --pop-bottom-span-left {
		position-area: bottom span-left;
	}
	@position-try --pop-left {
		position-area: left;
	}
	@position-try --pop-right {
		position-area: right;
	}

	@supports (anchor-name: --anchor) {
		.stuic-dropdown-menu-dropdown {
			position-try-fallbacks:
				flip-inline, --pop-bottom-span-right, --pop-bottom-span-left, --pop-bottom,
				flip-block, --pop-top-span-right, --pop-top-span-left, --pop-top, --pop-left,
				--pop-right;
		}
	}

	/* =============================================================================
	   SEARCH INPUT
	   ============================================================================= */

	.stuic-dropdown-menu-search {
		position: sticky;
		top: 0;
		z-index: 10;
		display: flex;
		align-items: center;
		gap: calc(var(--spacing) * 1);
		padding: calc(var(--spacing) * 1.5) calc(var(--spacing) * 2);
		background: var(--stuic-dropdown-menu-search-bg);
		border-bottom: 1px solid var(--stuic-dropdown-menu-search-border);
		margin: calc(var(--stuic-dropdown-menu-padding) * -1);
		margin-bottom: var(--stuic-dropdown-menu-padding);
	}

	.stuic-dropdown-menu-search-icon {
		color: var(--stuic-dropdown-menu-search-text);
		flex-shrink: 0;
		display: flex;
	}

	.stuic-dropdown-menu-search-input {
		flex: 1;
		min-width: 0;
		background: transparent;
		border: none;
		outline: none;
		color: var(--stuic-dropdown-menu-text);
		font-size: inherit;
	}

	.stuic-dropdown-menu-search-input::placeholder {
		color: var(--stuic-dropdown-menu-search-text);
	}

	.stuic-dropdown-menu-search-clear {
		background: transparent;
		border: none;
		color: var(--stuic-dropdown-menu-search-text);
		cursor: pointer;
		padding: calc(var(--spacing) * 0.5);
		display: flex;
		border-radius: var(--stuic-dropdown-menu-radius);
		transition: color var(--stuic-dropdown-menu-transition);
	}

	.stuic-dropdown-menu-search-clear:hover {
		color: var(--stuic-dropdown-menu-text);
	}

	.stuic-dropdown-menu-no-results {
		padding: calc(var(--spacing) * 4);
		text-align: center;
		color: var(--stuic-dropdown-menu-search-text);
	}
}
